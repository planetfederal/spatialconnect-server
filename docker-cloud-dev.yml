authorizedkeys:
  autodestroy: always
  deployment_strategy: every_node
  environment:
    - AUTHORIZED_KEYS=ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC7oJ/blBKJOHbhBbOLve6xWyzggSR/F680yTu0L1Mwp/KM1kJZTaMcsNH2GzPdHfwcliuM5xgEI45d5nRIeQJhusw+95SEdqEQdM3SIiZMyJLqRBQ3w37ewOy3VxvA5ife5jvCNdTMJcP+pxAKiNz5X7bsrhDUAvBxtvuoSFEb46DO+GQ8x1b+FaiK6PrMpFUkCDf84CjUB+zZXUnGSmPyqqd5y1Qf1a6RizmOR3oCBWRaT7Si5mfgJi8q0SmRLPCjy/+njv0PLnMjI2DSgfPvLqJR8OjxqXBU9SP6sJJ1ldDrUaA9qVfEdbDOXx/tUd38HDfbwqtrxXW4+P7mj+St
  image: 'dockercloud/authorizedkeys:latest'
  tags:
    - develop
  volumes:
    - '/root:/user'
geoserver:
  environment:
    - 'JAVA_OPTS=-Xmx1536M -XX:MaxPermSize=756M'
    - VIRTUAL_HOST=geoserver
  image: 'kartoza/geoserver:latest'
  links:
    - nginx
    - postgis
  ports:
    - '8080:8080'
  tags:
    - develop
kafka:
  environment:
    - KAFKA_ADVERTISED_HOST_NAME=
    - KAFKA_AUTO_CREATE_TOPICS_ENABLE=true
    - KAFKA_LOG_CLEANUP_POLICY=compact
  image: 'confluent/kafka:0.10.0.0-cp1'
  links:
    - zookeeper
  ports:
    - '9092:9092'
  tags:
    - develop
mosquitto:
  autoredeploy: true
  image: 'boundlessgeo/mosquitto:latest'
  ports:
    - '1883:1883'
    - '8883:8883'
    - '8884:8884'
  tags:
    - develop
nginx:
  image: 'nginx:latest'
  ports:
    - '80:80'
  tags:
    - develop
  volumes:
    - '/var/run/docker.sock:/tmp/docker.sock:ro'
  volumes_from:
    - nginx-config
nginx-config:
  autoredeploy: true
  image: 'mrcnc/nginx-config:development'
  mem_limit: 64m
  restart: always
  tags:
    - develop
postgis:
  environment:
    - POSTGRES_USER=spacon
  image: 'mdillon/postgis:latest'
  ports:
    - '5432:5432'
  tags:
    - develop
spatialconnect-server:
  autoredeploy: true
  command: java -jar /opt/spacon-server.jar
  environment:
    - DB_HOST=postgis
    - KEY_STORE=/opt/tls/test-keystore.p12
    - 'MQTT_BROKER_URL=ssl://mosquitto:8884'
    - TRUST_STORE=/opt/tls/test-cacerts.jks
    - VIRTUAL_HOST=efc-dev.boundlessgeo.com
  image: 'boundlessgeo/spatialconnect-server:latest'
  links:
    - mosquitto
    - nginx
    - postgis
  ports:
    - '8085:8085'
  restart: always
  tags:
    - develop
zookeeper:
  hostname: zookeeper
  image: 'confluent/zookeeper:3.4.6-cp1'
  ports:
    - '2181:2181'
  tags:
    - develop
